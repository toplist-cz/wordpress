jQuery(document).ready(function(a){function h(){if(!u&&d)clearInterval(d),d=0;else{var e="",f;m.show();v.hide();var c=""==n.text().trim();a.post(ajaxurl,y,function(a){c&&!p&&b.hide();m.hasClass("reload")?m.fadeOut():m.hide();a.success&&r&&(r=!1,g=9E5,d&&clearInterval(d),d=setInterval(h,g));if(!a.success&&a.hasOwnProperty("reload")&&1==a.reload){f="Do\u0161lo k chyb\u011b p\u0159i na\u010d\u00edt\u00e1n\u00ed. Zkus\u00edm to za chv\u00edli znova.";""!=a.html.trim()&&(f+="<br />"+a.html.trim());c||t||v.show().attr("title",f.replace("<br />","\n").replace("na\u010d\u00edt\u00e1n\u00ed","obnovov\u00e1n\u00ed"));if(r)return;c&&(t=!0,e=f);r=!0;g=6E4;d&&clearInterval(d);d=setInterval(h,g)}else e=a.html,a.success||(d&&clearInterval(d),d=0);m.addClass("reload");a.success&&t&&(p||b.slideUp("fast").promise(),t=!1,c=!0);""!=e&&(n.html(e),c&&!p&&b.slideDown("fast",function(){b.removeAttr("style")}));!a.success&&c?b.addClass("error"):(c=!1,b.removeClass("error"),q())}).fail(function(){c&&!p&&b.hide();b.find(".spinner").hide();n.html("fail");b.addClass("error");c&&!p&&b.slideDown("fast",function(){b.removeAttr("style")})})}}function w(a,f){f=f||0;var c=[],b;for(b in a)c.push([parseInt(b)+f,parseInt(a[b])]);return c}function x(e,b,c){c=c||.35;var d=[{data:w(e.navstevy,-c),label:"N\u00e1v\u0161t\u011bvy",color:"#994c4c"},{data:w(e.zhlednuti),label:"Zhl\u00e9dnut\u00ed",color:"#404080"}];c={bars:{show:!0,lineWidth:1,barWidth:c},xaxis:{ticks:Object.keys(e.navstevy).length,minTickSize:1,tickDecimals:0,tickLength:0},grid:{hoverable:!0,borderWidth:1,borderColor:"LightGray"},legend:{labelFormatter:function(a,e){return a+" ("+e.data.reduce(function(a,e){return a+e[1]},0).toLocaleString()+")"}}};a.plot(b,d,c);b.attr("data",JSON.stringify(e))}function q(){if(!a("#toplist_cz_dashboard").hasClass("closed")){var e=JSON.parse(window.atob(a("#toplist_cz_dashboard #toplist_stats").attr("value")));x(e.navstevy_za_den,a("#navstevy-za-den .graph"));x(e.navstevy_za_mesic,a("#navstevy-za-mesic .graph"))}}function k(a){var b={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};a=a||window.event;"hidden"==(a.type in b?b[a.type]:this[l]?"hidden":"visible")?u=!1:(u=!0,d||(d=setInterval(h,g),h()))}var p=a("#toplist_cz_dashboard").hasClass("closed"),b=a("#toplist_cz_dashboard .inside"),n=b.find(".content"),m=b.find(".spinner"),v=b.find(".erroricon"),u=!0,g=9E5,r=!1,d=setInterval(h,g),t=!1;a("body").on("mouseenter","#toplist_cz_dashboard .inside table tr td",function(b,f,c){b=a(this);this.offsetWidth<this.scrollWidth&&!b.attr("title")&&b.attr("title",b.text())});a("body").on("plothover","#toplist_cz_dashboard .inside div.graph",function(b,f,c){if(c){if(previousPoint!=c.datapoint){previousPoint=c.datapoint;a("#flot-tooltip").remove();b=JSON.parse(a(this).attr("data"));var d=f=Math.round(c.datapoint[0]);0<=a(this).parent().attr("id").indexOf("za-den")?d=f+"<sup>00</sup> &ndash; "+(f+1)+"<sup>00</sup>":0<=a(this).parent().attr("id").indexOf("za-mesic")&&(d=JSON.parse(window.atob(a("#toplist_cz_dashboard #toplist_stats").attr("value"))),d=f+". "+d.navstevy_za_mesic.mesic.toLowerCase());var g=c.pageX;c=c.pageY;a('<div id="flot-tooltip">'+("<strong>"+d+"</strong><br />N\u00e1v\u0161t\u011bvy: <strong>"+b.navstevy[f]+"</strong><br />Zhl\u00e9dnut\u00ed: <strong>"+b.zhlednuti[f]+"</strong>")+"</div>").css({top:c-20,left:100>g?g+25:g-95,"border-color":void 0}).appendTo("body").show()}}else a("#flot-tooltip").remove(),previousPoint=null});var y={action:"toplist_cz_dashboard_content",_wpnonce:a("#toplist_cz_dashboard .inside #toplist_nonce").attr("value")};a(window).resize(q);a("#toplist_cz_dashboard .handlediv").click(q);a("body").on("click","#toplist_cz_dashboard #toplist_password_form #toplist_password_submit",function(){b.removeClass("toplist_error_pulsate");var e=a(this).parents("form").find("#toplist_password");""==e.val()?(e.css("background-color","LightPink"),alert("Please fill-in the password.")):(a("#toplist_cz_dashboard .inside #toplist_password_form .spinner").css("display","inline-block"),e={action:"toplist_cz_save_password",_wpnonce:a(this).parents("form").find("#toplist_password_nonce").val(),password:e.val()},a("form#toplist_password_form input").attr("disabled",!0),a.post(ajaxurl,e,function(a){a.success?(b.removeClass("error"),b.slideUp("fast"),n.html(a.html),b.slideDown("fast"),b.find(".spinner").hide().addClass("reload"),b.find(".erroricon").hide(),initial_fetch=!1,q(),g=9E5,d&&clearInterval(d),d=setInterval(h,g)):(b.html(a.html),b.addClass("toplist_error_pulsate"))}).fail(function(){b.html("fail");b.addClass("toplist_error_pulsate")}))});""==n.text().trim()?h():(m.addClass("reload"),q());var l="hidden";l in document?document.addEventListener("visibilitychange",k):(l="mozHidden")in document?document.addEventListener("mozvisibilitychange",k):(l="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",k):(l="msHidden")in document?document.addEventListener("msvisibilitychange",k):"onfocusin"in document?document.onfocusin=document.onfocusout=k:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=k;void 0!==document[l]&&k({type:document[l]?"blur":"focus"})});